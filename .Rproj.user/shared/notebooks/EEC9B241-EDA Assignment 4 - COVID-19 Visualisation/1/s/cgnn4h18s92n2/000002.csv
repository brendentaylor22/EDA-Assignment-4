"0","#Need to add geometry data to ncov data"
"0","#First create column in ncov for World Bank country code. Will then use this code to join geometry data"
"0","ncov$iso3c = countrycode(sourcevar = ncov$Country, origin = ""country.name"", destination = ""wb"")"
"0",""
"0","#Missing code for Holy See, Diamond Princess and MS Zaandam"
"0","#Need to replace Holy See with Vatican"
"0","ncov$Country = ncov$Country %>%"
"0","  recode(""Holy See"" = ""Vatican"") %>%"
"0","  recode(""Taiwan*"" = ""Taiwan"")"
"0",""
"0","#Add code for missing countries"
"0","ncov = ncov %>%"
"0","  mutate(iso3c = ifelse(Country==""Vatican"", ""VAT"", iso3c)) %>%"
"0","  mutate(iso3c = ifelse(Country==""Western Sahara"", ""ESH"", iso3c)) %>%"
"0","  mutate(iso3c = ifelse(Country==""Diamond Princess"", ""CDP"", iso3c)) %>%"
"0","  mutate(iso3c = ifelse(Country==""MS Zaandam"", ""CMZ"", iso3c))"
"0",""
"0","#Create column in world_geom for iso3c"
"0","world_geom$iso3c = countrycode(sourcevar = world_geom$name_long, "
"0","                               origin = ""country.name"", destination = ""wb"")"
"0",""
"0","world_ne$iso3c = countrycode(sourcevar = world_ne$sovereignt, "
"0","                               origin = ""country.name"", destination = ""wb"")"
"0",""
"0","#Few countries without countrycodes so need to insert manually"
"0","world_ne = world_ne %>%"
"0","  mutate(iso3c = ifelse(sovereignt == ""Western Sahara"", ""ESH"", iso3c)) %>%"
"0","  mutate(iso3c = ifelse(sovereignt == ""Vatican"", ""VAT"", iso3c))"
"0",""
"0","#West Bank and Gaza still need geometry data. Use world_geom from world to extract geometry data and then add to world_ne"
"0","palest = world_geom %>%"
"0","  filter(name_long == ""Palestine"") %>%"
"0","  select(c(name_long, geom)) %>%"
"0","  mutate(iso3c = ""PSE"")"
"0",""
"0","colnames(palest) = c(""sovereignt"", ""geometry"", ""iso3c"")"
"0",""
"0","#Convert both to data frame and then rbind and convert back to sf"
"0","palest_df = as.data.frame(palest)"
"0","world_ne_df = as.data.frame(world_ne)"
"0","world_ne_df2 = rbind(world_ne_df, palest_df)"
"0","world_ne_full = st_as_sf(world_ne_df2)"
"0",""
"0","#Join ncov and geometry data"
"0","dat = left_join(ncov, world_ne_full, by = c(""iso3c""))"
"0","dat = dat %>%"
"0","  select(-sovereignt)"
"0",""
"0","#As of 8 April, both Diamond Princess and MS Zaandam had been evacuated and passengers sent to their respective countries. These two cruise ships will be ignored when plotting on a map but will be kept for total cases/deaths/recovered etc."
"0",""
"0","dat_cruise = dat %>%"
"0","  filter(Country == ""Diamond Princess"") %>%"
"0","  filter(Country == ""MS Zaandam"")"
"0",""
"0","dat = dat %>%"
"0","  filter(!(Country == ""Diamond Princess"")) %>%"
"0","  filter(!(Country == ""MS Zaandam""))"
